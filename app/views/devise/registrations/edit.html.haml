.devise-registration-edit-container
  .form-container
    %h2
      Edit #{resource_name.to_s.humanize}
    = form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f|
      = devise_error_messages!

      .name.form-group
        = f.label :name, class: 'required'
        .input-group
          = f.text_field :name, autofocus: true

      .email.form-group
        = f.label :email, class: 'required'
        .input-group
          = f.email_field :email

      - if devise_mapping.confirmable? && resource.pending_reconfirmation?
        %div
          Currently waiting confirmation for: #{resource.unconfirmed_email}

      .password.form-group
        = f.label :password, class: 'required'
        .input-group
          = f.password_field :password, autocomplete: "off"
          .help-block (leave blank if you don't want to change it). Using numbers, symbols and mix of upper and lower case letters in your password makes it more secure.

      .password-confirmation.form-group
        = f.label :password_confirmation, class: 'required'
        .input-group
          = f.password_field :password_confirmation, autocomplete: "off"

      .password_current.form-group
        = f.label :current_password
        .input-group
          = f.password_field :current_password, autocomplete: "off"
          .help-block (we need your current password to confirm your changes)

      .address.form-group
        = f.label :address, class: 'required'
        .input-group
          = f.text_area :address

      .unit.form-group
        = f.label :unit
        .input-group
          = f.text_field :unit

      .postal.form-group
        = f.label :postal, class: 'required'
        .input-group
          = f.text_field :postal

      .instruction.form-group
        = f.label :instruction, 'Special Instruction'
        .input-group
          = f.text_area :instruction
          .help-block eg. I have two dogs at home. My main priority is ironing.

      .contact_number.form-group
        = f.label :contact_number, class: 'required'
        .input-group
          = f.text_field :contact_number


      .div= f.submit "Update", class: "button-submit"
      %br
    %h3 Cancel my account
    %p= "Unhappy about our services?"
    .cancel_acc_button
      = form_tag(registration_path(resource_name), method: :delete) do
        = button_tag "Cancel my account", type: 'button', class: "button-warning", id: "delete_account_button"
    .div_text.btn="or"
    .div_back_button
      #{link_to "Back", :back, class: "btn"}

:javascript
  $('#delete_account_button').click(function(e) {
    bootbox.confirm({
      title: "Notification",
      message: "Are you sure you want to proceed?",
      buttons: {
          cancel: {
              label: "No, keep my account",
              className: "btn-default pull-left"
          },
          confirm: {
              label: "Yes, cancel",
              className: "btn-danger pull-right"
          }
      },
      callback: function(result) {
        if (result) {
          $('.delete_button').parents('form').submit();
        } else {

        }
      }
    })
  });
